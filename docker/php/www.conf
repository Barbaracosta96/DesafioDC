; PHP-FPM Pool otimizado para maquina com ~2.5GB no WSL2
; Cada worker PHP consome aprox 30-50MB

[www]
user = www
group = www

; Ouve na porta 9000 (padrao Docker)
listen = 0.0.0.0:9000
listen.backlog = 128

; dynamic: cria/destroi workers conforme demanda (melhor para RAM limitada)
pm = dynamic

; Maximo de workers simultaneos (5 workers * ~40MB = ~200MB reservados)
pm.max_children = 5

; Workers inicializados ao subir o container
pm.start_servers = 2

; Minimo de workers ociosos (nao matar todos para re-iniciar rapido)
pm.min_spare_servers = 1

; Maximo de workers ociosos (libera RAM se o trafego cair)
pm.max_spare_servers = 3

; Requisicoes por worker antes de reiniciar (evita memory leaks)
pm.max_requests = 500

; Status page (util para debug de performance)
pm.status_path = /status

; Timeout de requisicao (evita travamento por query lenta)
request_terminate_timeout = 120s

; Slowlog desabilitado: ptrace nao e permitido em Docker sem privilegios extras
; slowlog = /var/log/php-fpm-slow.log
; request_slowlog_timeout = 3s

; Variaveis de ambiente necessarias
env[HOSTNAME] = $HOSTNAME
env[PATH] = /usr/local/bin:/usr/bin:/bin
env[TMP] = /tmp
env[TMPDIR] = /tmp
env[TEMP] = /tmp
